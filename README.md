# Unsupervised Probing Critical Transitions in Complex Systems Using Generative Diffusion Models
* This repository contains the source codes and data for our paper submitted and under review :
* Peng Zhang, Jun Fu, Tonglei Cheng and Rolf Findeisen, Unsupervised Probing Critical Transitions in Complex Systems Using Generative Diffusion Models.
* This repository contains the implementation for using generative diffusion models (specifically NsDiff and DiffSTG) as unsupervised probes to detect critical transitions (tipping points) in complex dynamical systems. The core discovery is the "variance collapse" phenomenon, where the predictive uncertainty of the model sharply declines as the system approaches a critical point.
##  Quick Start
### Prerequisites

*   Python 3.8+
*   Additional dependencies listed in `requirements.txt`
### Installation
1.  Clone the repository:

" git clone https://github.com/curious-child/Unsupervised-Probing-Critical-Transitions.git
 cd Unsupervised-Probing-Critical-Transitions "
2.  Install dependencies:
"pip install -r requirements.txt"

##  Model Architectures
The repository provides two diffusion models, as detailed in the paper:
1.  **`NsDiff`** （See `./models/Diffusion_model/NsDiff`）: Designed for **non-stationary** time-series data. It uses a Location-Scale Noise Model (LSNM) to capture time-varying uncertainty. Its architectural bias filters out microscopic fluctuations, producing a sharp "variance collapse" signal.
2.  **`DiffSTG`** （See `./models/Diffusion_model/DiffSTG`）: Tailored for **spatio-temporal graph** data. It uses a standard Gaussian diffusion process with a U-Net-like denoising network (`UGnet`) that incorporates graph convolutions. Its predictive uncertainty is state-dependent, tied to the current attractor basin.

##  Datasets & Dynamical Systems

The code can generate time-series data from several dynamical systems exhibiting critical transitions:
### Networked Dynamical Systems:
*   **Resource Biomass Model** （See `./dataset/spdata_sde_biomass_dynamic_gene.py`）: First-order (explosive) transition.
*   **Wilson-Cowan Neuronal Model** （See `./dataset/spdata_sde_neuronal_dynamic_gene.py`）: First-order (explosive) transition.
*   **SIS Epidemic Model** （See `./dataset/spdata_sde_SIS_dynamic_gene.py`）: Second-order (smooth) transition.
*   **Network Topologies** （See `./dataset/graph_generate.py`）: Barabási–Albert (BA), Erdős–Rényi (ER), and Watts–Strogatz (WS) networks.

### Toy Model for Interpretability:
*   **Shallow Lake with Bream and Pike (SLBP) Model** （See `./dataset/SLBP_dynamic_gene.py`）: A single-node, two-variable system for detailed bifurcation and trajectory analysis.
## Usage
### Configuration and Training
* All training process of our models are configured through YAML files. 
* To training models with different configurations for Networked dynamical systems:

"python main_SSLtrain_diffusion_spdata.py --cfg configs/grid_search/diffusion_model_NsDiff.yaml"

* To training models with different configurations for the Shallow Lake with Bream and Pike (SLBP) model:

"python main_SSLtrain_diffusion_timeseries.py --cgf configs/grid_search/diffusion_model_NsDiff.yaml"

### Reproducing Experiments

#### Experiment 1: Architecture Comparison
To compare the early warning signals generated by NsDiff and DiffSTG architectures, run:
"python diffusion_ews_spdata_NsDiff.py
python diffusion_ews_DiffSTG.py
python diffusion_model_ews_compare.py"

#### Experiment 2:The generalization ability of variance-collapse signals
To assess the robustness of the observed phenomenon across network topologies, we applied the NsDiff model to the 
same type of networked systems with different underlying topologies, i.e., run:
"python diffusion_ews_spdata_NsDiff.py
python NsDiff_ews_generalization_graph.py"

To evaluate the cross-system transferability of NsDiff by applying models trained exclusively on one networked system to entirely unseen systems for critical transition detection, run:
" python diffusion_ews_spdata_NsDiff.py
python NsDiff_ews_generalization_dynamics.py "

#### Experiment 3: Mechanism Analysis
To validate robustness to noise,  and parameter variations, we run:
" python diffusion_ews_model_grid_SLBP.py
python diffusion_ews_dynamic_grid_SLBP.py
python diffusion_SLBP_ews_model_sensivity.py "
To investigate the mechanistic basis of variance collapse through PCA and entropy analysis, we run:

" python diffusion_SLBP_model_analysis.py "

##  License

This project is licensed under the MIT License - see the [LICENSE](README.md) file for details.



